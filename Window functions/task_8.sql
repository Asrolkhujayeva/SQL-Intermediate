-- Ranking Customer Order Quantity


SELECT 
    customerkey,
    COUNT(*) AS total_orders,
    ROW_NUMBER() OVER (ORDER BY COUNT(*) DESC) AS total_orders_row_num,
    RANK() OVER (ORDER BY COUNT(*) DESC) AS total_orders_rank,
    DENSE_RANK() OVER (ORDER BY COUNT(*) DESC) AS total_orders_rank
FROM sales
GROUP BY customerkey
LIMIT 50


/*
index,customerkey,total_orders,total_orders_row_num,total_orders_rank,total_orders_rank
0,1834524,31,1,1,1
1,1375597,30,2,2,2
2,249557,27,3,3,3
3,459519,26,4,4,4
4,1495941,26,5,4,4
5,1801215,26,6,4,4
6,1219056,25,7,7,5
7,759419,24,8,8,6
8,1427444,24,9,8,6
9,1876222,24,10,8,6
10,2079681,22,11,11,7
11,578215,22,12,11,7
12,1743963,22,13,11,7
13,1780427,22,14,11,7
14,1496962,22,15,11,7
15,1552351,21,16,16,8
16,1390742,21,17,16,8
17,1071231,21,18,16,8
18,1289648,21,19,16,8
19,1295351,21,20,16,8
20,2032301,21,21,16,8
21,1481672,21,22,16,8
22,399184,21,23,16,8
23,375982,21,24,16,8
24,1764902,21,25,16,8
25,343451,21,26,16,8
26,2059525,21,27,16,8
27,1975724,21,28,16,8
28,433710,20,29,29,9
29,1532987,20,30,29,9
30,2073362,20,31,29,9
31,1246962,20,32,29,9
32,347069,20,33,29,9
33,1007645,20,34,29,9
34,1580709,20,35,29,9
35,1938474,20,36,29,9
36,1948271,20,37,29,9
37,2061146,20,38,29,9
38,541005,20,39,29,9
39,1885137,20,40,29,9
40,1483592,20,41,29,9
41,1346733,20,42,29,9
42,1338460,20,43,29,9
43,1987438,20,44,29,9
44,1344284,19,45,45,10
45,1434512,19,46,45,10
46,1815231,19,47,45,10
47,1820306,19,48,45,10
48,1248077,19,49,45,10
49,550883,19,50,45,10
*/


