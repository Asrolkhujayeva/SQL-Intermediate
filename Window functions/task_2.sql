

SELECT *,
      100 * net_revenue / daily_net_revenue as prc_daily_net_revenue
FROM (
      SELECT 
        orderdate,
        orderkey * 10 + linenumber AS order_line_number,
        (quantity * netprice * exchangerate) AS net_revenue,
        SUM(quantity * netprice * exchangerate) OVER(PARTITION BY orderdate) AS daily_net_revenue
      FROM sales
) AS revenue_by_day

/*
index,orderdate,order_line_number,net_revenue,daily_net_revenue,prc_daily_net_revenue
0,2015-01-01,10000,63.49227885,11640.795090172998,0.5454290566767155
1,2015-01-01,10001,423.28185899999994,11640.795090172998,3.636193711178103
2,2015-01-01,10010,108.752,11640.795090172998,0.9342317183454845
3,2015-01-01,10020,1146.7456,11640.795090172998,9.851093427184086
4,2015-01-01,10021,950.25,11640.795090172998,8.16310219911171
5,2015-01-01,10022,1302.9119999999998,11640.795090172998,11.192637529543841
6,2015-01-01,10023,58.73466,11640.795090172998,0.5045588342121321
7,2015-01-01,10030,224.97750000000002,11640.795090172998,1.9326643777960064
8,2015-01-01,10040,263.10501993599996,11640.795090172998,2.2601980182445582
9,2015-01-01,10041,578.52372105,11640.795090172998,4.969795590151586
10,2015-01-01,10042,9.65335554,11640.795090172998,0.08292694326480528
11,2015-01-01,10043,2395.0955025,11640.795090172998,20.575016430981652
12,2015-01-01,10050,975.156,11640.795090172998,8.377056656750305
13,2015-01-01,10051,6.1794096,11640.795090172998,0.053084085340670356
14,2015-01-01,10060,63.2896,11640.795090172998,0.5436879483724288
15,2015-01-01,10061,1552.32,11640.795090172998,13.33517159244945
16,2015-01-01,10070,142.42409999999998,11640.795090172998,1.223491169604321
17,2015-01-01,10071,11.426339105999999,11640.795090172998,0.09815772047775292
18,2015-01-01,10072,32.106048975,11640.795090172998,0.27580632359127677
19,2015-01-01,10073,142.42409999999998,11640.795090172998,1.223491169604321
20,2015-01-01,10074,67.61341641599999,11640.795090172998,0.5808316003524392
21,2015-01-01,10075,37.507579199999995,11640.795090172998,0.3222080528817433
22,2015-01-01,10080,247.975,11640.795090172998,2.1302239072083413
23,2015-01-01,10081,574.05,11640.795090172998,4.93136418563544
24,2015-01-01,10082,262.8,11640.795090172998,2.2575777510408392
25,2015-01-02,20000,296.97299999999996,5890.40005196,5.041643986492628
26,2015-01-02,20010,2475.0,5890.40005196,42.017519661953294
27,2015-01-02,20020,44.8,5890.40005196,0.760559547820407
28,2015-01-02,20021,749.8125,5890.40005196,12.729398570314485
29,2015-01-02,20030,8.12590296,5890.40005196,0.13795163126986845
30,2015-01-02,20031,1291.438149,5890.40005196,21.92445568396124
31,2015-01-02,20040,311.988,5890.40005196,5.296550272441811
32,2015-01-02,20050,712.2625,5890.40005196,12.091920645746265
33,2015-01-03,30000,293.24294999999995,19796.672329622,1.481273949062727
34,2015-01-03,30001,32.98617,19796.672329622,0.16662482184262048
35,2015-01-03,30010,117.9706632192,19796.672329622,0.5959115817797271
36,2015-01-03,30020,273.5709126656,19796.672329622,1.3819035245446405
37,2015-01-03,30021,212.21882880000004,19796.672329622,1.0719924301745118
38,2015-01-03,30022,90.157056,19796.672329622,0.4554152056408839
39,2015-01-03,30030,239.14368,19796.672329622,1.2079993850389008
40,2015-01-03,30040,251.1839,19796.672329622,1.268818798521762
41,2015-01-03,30050,299.2275,19796.672329622,1.5115040296558442
42,2015-01-03,30051,392.832,19796.672329622,1.9843334953430567
43,2015-01-03,30060,2399.76,19796.672329622,12.122037280019079
44,2015-01-03,30070,86.51022624,19796.672329622,0.4369937775378223
45,2015-01-03,30071,22.9589889984,19796.672329622,0.11597398096065967
46,2015-01-03,30080,543.0,19796.672329622,2.742885223126629
47,2015-01-03,30081,563.472,19796.672329622,2.8462965422571043
48,2015-01-03,30090,213.97183857000002,19796.672329622,1.0808475030918774
49,2015-01-03,30091,8165.927700000001,19796.672329622,41.24899156804866
*/
