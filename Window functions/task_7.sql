-- assigning row number

WITH row_numbering AS (
    SELECT
      ROW_NUMBER() OVER(
        PARTITION BY orderdate
        ORDER BY orderdate, orderkey, linenumber
      ) AS row_num,
      *
    FROM sales
)

SELECT *
FROM row_numbering
WHERE orderdate > '2012-01-01'
LIMIT 10

/*
index,row_num,orderkey,linenumber,orderdate,deliverydate,customerkey,storekey,productkey,quantity,unitprice,netprice,unitcost,currencycode,exchangerate
0,1,1000,0,2015-01-01,2015-01-01,947009,400,48,1,112.4625,98.967,57.3375,GBP,0.64155
1,2,1000,1,2015-01-01,2015-01-01,947009,400,460,1,749.75,659.78,382.25,GBP,0.64155
2,3,1001,0,2015-01-01,2015-01-01,1772036,430,1730,2,54.376,54.376,25.004,USD,1.0
3,4,1002,0,2015-01-01,2015-01-01,1518349,660,955,4,315.04,286.6864,144.88,USD,1.0
4,5,1002,1,2015-01-01,2015-01-01,1518349,660,62,7,135.75,135.75,62.43,USD,1.0
5,6,1002,2,2015-01-01,2015-01-01,1518349,660,1050,3,499.2,434.304,229.568,USD,1.0
6,7,1002,3,2015-01-01,2015-01-01,1518349,660,1608,1,65.994,58.73466,33.648,USD,1.0
7,8,1003,0,2015-01-01,2015-01-01,1317097,510,85,3,74.9925,74.9925,34.485,USD,1.0
8,9,1004,0,2015-01-01,2015-01-01,254117,80,128,2,114.72,113.5728,58.488,CAD,1.15831
9,10,1004,1,2015-01-01,2015-01-01,254117,80,2079,1,499.455,499.455,165.48,CAD,1.15831
*/